# å¿«é€Ÿå¼€å§‹æŒ‡å—

## 5åˆ†é’Ÿä¸Šæ‰‹è‡ªåŠ¨åŒ–æµ‹è¯•

### ç¬¬ä¸€æ­¥: ç¯å¢ƒæ£€æŸ¥

åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ:
```bash
cd AutoTest
python utils.py check
```

è¿™ä¼šè‡ªåŠ¨æ£€æŸ¥:
- âœ“ adbæ˜¯å¦å·²å®‰è£…
- âœ“ è®¾å¤‡æ˜¯å¦è¿æ¥
- âœ“ Appæ˜¯å¦å·²å®‰è£…
- âœ“ Appæ˜¯å¦å¯è°ƒè¯•

å¦‚æœæ‰€æœ‰æ£€æŸ¥éƒ½é€šè¿‡,ä½ å°±å¯ä»¥å¼€å§‹æµ‹è¯•äº†!

### ç¬¬äºŒæ­¥: å‡†å¤‡æµ‹è¯•æ•°æ®

ç¡®ä¿ä½ çš„Appåœ¨å…³é”®æ“ä½œæ—¶ä¼šæ›´æ–°JSONæ–‡ä»¶ã€‚æµ‹è¯•æ•°æ®æ–‡ä»¶ä½äºAppçš„`files/autotest/`ç›®å½•ã€‚

**æŸ¥çœ‹ç°æœ‰çš„æµ‹è¯•æ–‡ä»¶:**
```bash
python utils.py list
```

**æŸ¥çœ‹æŸä¸ªæ–‡ä»¶çš„å†…å®¹:**
```bash
python utils.py view playback_state.json
```

### ç¬¬ä¸‰æ­¥: è¿è¡Œæµ‹è¯•

#### æ–¹å¼1: è¿è¡Œæ‰€æœ‰æµ‹è¯•
```bash
python run_all_tests.py
```

è¾“å‡ºç¤ºä¾‹:
```
======================================================================
éŸ³ä¹Appè‡ªåŠ¨åŒ–æµ‹è¯• - æ‰¹é‡æµ‹è¯•è¿è¡Œå™¨
======================================================================
å¼€å§‹æ—¶é—´: 2025-11-03 14:30:00
æµ‹è¯•ç”¨ä¾‹æ•°é‡: 27
======================================================================

[ä»»åŠ¡01] æ‰“å¼€appå¹¶è¿›å…¥'æ¨è'é¦–é¡µ... âœ“ é€šè¿‡
[ä»»åŠ¡02] ä»'æ¨è'é¡µé¢è¿›å…¥'æ¼«æ¸¸'é¡µé¢... âœ“ é€šè¿‡
[ä»»åŠ¡04] æ’­æ”¾å½“å‰æš‚åœçš„æ­Œæ›²... âœ“ é€šè¿‡
...
======================================================================
æµ‹è¯•æ€»ç»“
======================================================================
æ€»è®¡: 27 ä¸ªæµ‹è¯•
é€šè¿‡: 25 (92.6%)
å¤±è´¥: 2 (7.4%)
é”™è¯¯: 0 (0.0%)
```

#### æ–¹å¼2: æŒ‰éš¾åº¦è¿è¡Œæµ‹è¯•
```bash
# åªè¿è¡Œä½éš¾åº¦æµ‹è¯•
python run_all_tests.py ä½

# åªè¿è¡Œä¸­éš¾åº¦æµ‹è¯•
python run_all_tests.py ä¸­

# åªè¿è¡Œé«˜éš¾åº¦æµ‹è¯•
python run_all_tests.py é«˜
```

#### æ–¹å¼3: è¿è¡Œå•ä¸ªæµ‹è¯•
```python
# åˆ›å»ºtest_single.py
from verification_functions import *

# æµ‹è¯•ä»»åŠ¡1
result = task_01_check_open_recommend_page()
print(f"ä»»åŠ¡1: {'é€šè¿‡' if result else 'å¤±è´¥'}")

# æµ‹è¯•ä»»åŠ¡8(éœ€è¦å‚æ•°)
result = task_08_check_favorite_song("song_001")
print(f"ä»»åŠ¡8: {'é€šè¿‡' if result else 'å¤±è´¥'}")
```

### ç¬¬å››æ­¥: æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š

è¿è¡Œå®Œæµ‹è¯•å,ä¼šè‡ªåŠ¨ç”ŸæˆJSONæ ¼å¼çš„æµ‹è¯•æŠ¥å‘Š:
```
test_report_20251103_143000.json
```

æŠ¥å‘ŠåŒ…å«:
- æµ‹è¯•æ—¶é—´
- é€šè¿‡ç‡
- æ¯ä¸ªä»»åŠ¡çš„è¯¦ç»†ç»“æœ
- é”™è¯¯ä¿¡æ¯(å¦‚æœæœ‰)

## å¸¸è§é—®é¢˜

### Q: æç¤º"adb command not found"
**A:** å®‰è£…Android SDK Platform Tools:
1. ä¸‹è½½: https://developer.android.com/studio/releases/platform-tools
2. è§£å‹åæ·»åŠ åˆ°ç³»ç»ŸPATH
3. é‡å¯å‘½ä»¤è¡Œçª—å£
4. è¿è¡Œ`adb version`éªŒè¯

### Q: æç¤º"run-as: Package is not debuggable"
**A:** ç¡®ä¿ä½¿ç”¨çš„æ˜¯debugç‰ˆæœ¬çš„App:
1. åœ¨Android Studioä¸­é€‰æ‹©"Build > Build Bundle(s) / APK(s) > Build APK(s)"
2. ä½¿ç”¨debugç‰ˆæœ¬(app-debug.apk)
3. æˆ–åœ¨build.gradleä¸­è®¾ç½®debuggable = true

### Q: æ‰€æœ‰æµ‹è¯•éƒ½å¤±è´¥
**A:** å¯èƒ½çš„åŸå› :
1. Appæ²¡æœ‰åˆ›å»ºautotestç›®å½•å’ŒJSONæ–‡ä»¶
2. JSONæ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®
3. è¿è¡Œ`python utils.py list`æŸ¥çœ‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨
4. è¿è¡Œ`python utils.py view app_state.json`æŸ¥çœ‹æ–‡ä»¶å†…å®¹

### Q: å¦‚ä½•æ¸…ç©ºæµ‹è¯•æ•°æ®
**A:** è¿è¡Œæ¸…ç©ºå‘½ä»¤:
```bash
python utils.py clear
```

## Appç«¯é›†æˆæŒ‡å—

### 1. åˆ›å»ºautotestç›®å½•
```kotlin
val autotestDir = File(context.filesDir, "autotest")
if (!autotestDir.exists()) {
    autotestDir.mkdirs()
}
```

### 2. æ›´æ–°çŠ¶æ€æ–‡ä»¶ç¤ºä¾‹

**å¯¼èˆªæ—¶æ›´æ–°app_state.json:**
```kotlin
fun updateAppState(currentPage: String) {
    val file = File(context.filesDir, "autotest/app_state.json")
    val state = JSONObject().apply {
        put("currentPage", currentPage)
        put("lastUpdated", getCurrentTimestamp())
    }
    file.writeText(state.toString(2)) // æ ¼å¼åŒ–è¾“å‡º
}
```

**æ’­æ”¾æ—¶æ›´æ–°playback_state.json:**
```kotlin
fun updatePlaybackState(songId: String, isPlaying: Boolean) {
    val file = File(context.filesDir, "autotest/playback_state.json")
    val state = JSONObject().apply {
        put("currentSong", JSONObject().apply {
            put("songId", songId)
            put("songName", getSongName(songId))
        })
        put("isPlaying", isPlaying)
        put("playbackMode", currentPlaybackMode)
        put("lastUpdated", getCurrentTimestamp())
    }
    file.writeText(state.toString(2))
}
```

**æ”¶è—æ—¶æ›´æ–°user_favorites.json:**
```kotlin
fun addToFavorites(songId: String) {
    val file = File(context.filesDir, "autotest/user_favorites.json")

    // è¯»å–ç°æœ‰æ•°æ®
    val data = if (file.exists()) {
        JSONObject(file.readText())
    } else {
        JSONObject().put("favoriteSongs", JSONArray())
    }

    // æ·»åŠ æ–°æ”¶è—
    val favorites = data.getJSONArray("favoriteSongs")
    favorites.put(JSONObject().apply {
        put("songId", songId)
        put("songName", getSongName(songId))
        put("artist", getArtistName(songId))
        put("addedTime", getCurrentTimestamp())
    })

    data.put("lastUpdated", getCurrentTimestamp())
    file.writeText(data.toString(2))
}
```

### 3. æ—¶é—´æˆ³æ ¼å¼
```kotlin
fun getCurrentTimestamp(): String {
    val sdf = SimpleDateFormat("yyyy-MM-dd HH:mm:ss", Locale.getDefault())
    return sdf.format(Date())
}
```

## æµ‹è¯•å·¥ä½œæµç¨‹

### å…¸å‹çš„æµ‹è¯•æµç¨‹:
1. **å‡†å¤‡**: æ¸…ç©ºæ—§æ•°æ® â†’ `python utils.py clear`
2. **æ‰§è¡Œ**: æ‰‹åŠ¨æˆ–ç”¨GUI Agentæ‰§è¡Œä»»åŠ¡
3. **éªŒè¯**: è¿è¡Œæµ‹è¯•è„šæœ¬ â†’ `python run_all_tests.py`
4. **åˆ†æ**: æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š,å®šä½é—®é¢˜

### é›†æˆåˆ°CI/CD:
```bash
# åœ¨CI/CDè„šæœ¬ä¸­
cd AutoTest
python utils.py check || exit 1
python run_all_tests.py
exit_code=$?

if [ $exit_code -eq 0 ]; then
  echo "æ‰€æœ‰æµ‹è¯•é€šè¿‡"
elif [ $exit_code -eq 1 ]; then
  echo "éƒ¨åˆ†æµ‹è¯•å¤±è´¥"
  exit 1
elif [ $exit_code -eq 2 ]; then
  echo "æµ‹è¯•å‡ºç°é”™è¯¯"
  exit 2
fi
```

## ä¸‹ä¸€æ­¥

- é˜…è¯»[README.md](README.md)äº†è§£è¯¦ç»†ä¿¡æ¯
- æŸ¥çœ‹[éªŒè¯é€»è¾‘è¡¨.md](éªŒè¯é€»è¾‘è¡¨.md)äº†è§£æ‰€æœ‰æµ‹è¯•ä»»åŠ¡
- æŸ¥çœ‹[verification_functions.py](verification_functions.py)äº†è§£éªŒè¯å‡½æ•°å®ç°

## æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜,è¯·æŸ¥çœ‹:
1. README.md - å®Œæ•´æ–‡æ¡£
2. éªŒè¯é€»è¾‘è¡¨.md - ä»»åŠ¡åˆ¤æ–­æ ‡å‡†
3. verification_functions.py - æºä»£ç å®ç°

ç¥æµ‹è¯•é¡ºåˆ©! ğŸµ
