# 独立测试文件使用指南

## 📁 文件结构

```
AutoTest/
├── tests/                          # 独立测试文件目录
│   ├── __init__.py                # Python包初始化
│   ├── test_task_01.py            # 任务1测试
│   ├── test_task_02.py            # 任务2测试
│   ├── ...                        # 其他测试
│   └── test_task_31.py            # 任务31测试
├── verification_functions.py      # 验证函数库
├── run_single_test.py            # 单任务运行工具
├── run_all_tests.py              # 批量运行工具
├── utils.py                      # 环境检查工具
├── 测试清单.md                    # 测试进度跟踪
└── 快速开始.md                    # 快速开始指南
```

## 🚀 快速开始

### 1. 环境准备

```bash
# 检查环境是否就绪
cd AutoTest
python utils.py check
```

### 2. 启动App

在Android Studio或命令行中启动App：
```bash
# 方式1：Android Studio中直接运行

# 方式2：命令行安装运行
adb install -r ../app/build/outputs/apk/debug/app-debug.apk
adb shell am start -n com.example.mymusic/.MainActivity
```

### 3. 执行人工操作

在模拟器上按照任务要求进行操作。例如任务1：
- 启动App
- 确认进入推荐首页

### 4. 运行测试验证

```bash
# 运行单个任务测试
python run_single_test.py 1
```

## 📝 使用示例

### 示例1：测试任务1（打开推荐页面）

```bash
# 1. 在模拟器上启动App
# 2. 运行测试
python run_single_test.py 1

# 输出示例：
# ======================================================================
# 任务1：打开app并进入'推荐'首页
# ======================================================================
#
# 📋 人工操作步骤：
#   1. 在模拟器中启动App
#   2. 确认进入推荐首页
#
# 🔍 开始验证...
#
# ======================================================================
# ✓ 测试通过 - 已成功进入推荐首页
# ======================================================================
```

### 示例2：测试任务8（收藏歌曲）

```bash
# 1. 在模拟器上进入播放页面，点击收藏按钮
# 2. 运行测试（默认检查song_001）
python run_single_test.py 8

# 或指定歌曲ID
python run_single_test.py 8 song_002
```

### 示例3：测试多个任务

```bash
# 运行任务1, 2, 3
python run_single_test.py 1 2 3

# 运行任务1到10
python run_single_test.py 1-10

# 运行所有任务
python run_single_test.py all
```

### 示例4：直接运行单个测试文件

```bash
# 进入tests目录
cd tests

# 直接运行test_task_01.py
python test_task_01.py

# 带参数运行
python test_task_08.py song_002
python test_task_17.py 伤感
```

## 🛠️ 常用命令

### 环境检查
```bash
python utils.py check        # 检查adb、设备、App状态
python utils.py list         # 列出所有JSON文件
python utils.py view app_state.json  # 查看JSON文件内容
```

### 测试运行
```bash
# 单个任务
python run_single_test.py 1

# 多个任务
python run_single_test.py 1 4 7 8

# 任务范围
python run_single_test.py 1-10

# 所有任务
python run_single_test.py all

# 批量运行（使用原有工具）
python run_all_tests.py
python run_all_tests.py 低    # 只运行低难度任务
```

### 清理数据
```bash
python utils.py clear        # 清空所有测试数据（需确认）
```

## 📊 测试工作流

### 推荐的测试流程

```
1. 检查环境
   ↓
   python utils.py check

2. 启动App
   ↓
   (在模拟器中运行)

3. 执行一个任务
   ↓
   (手动操作：如播放歌曲、收藏等)

4. 立即测试
   ↓
   python run_single_test.py X

5. 记录结果
   ↓
   更新测试清单.md

6. 继续下一个任务
   ↓
   重复步骤3-5
```

### 批量测试流程

```
1. 准备环境并启动App

2. 执行多个任务
   (手动完成任务1, 2, 3, 4...)

3. 批量验证
   python run_single_test.py 1-10

4. 查看结果并记录
```

## 📋 任务分类

### 低难度任务（1-10）
- 页面导航
- 播放控制
- 基础操作

**建议**：先完成这些任务，熟悉流程

### 中难度任务（11-21）
- 搜索功能
- 歌单管理
- 场景切换

**建议**：需要多步操作，注意顺序

### 高难度任务（22-31）
- 统计查看
- 高级设置
- 跨页面操作

**建议**：可能需要特定数据或多次操作

### 不可测试任务
- 任务18：复制评论（剪贴板）
- 任务23：分享到微信（外部应用）
- 任务25：邀请好友（多用户）
- 任务26：听歌识曲（跨应用）

## 🐛 故障排查

### 问题1：所有测试都失败
**原因**：App可能没有正确记录数据
**解决**：
1. 检查App日志：`adb logcat | findstr AutoTestHelper`
2. 确认文件是否创建：`python utils.py list`
3. 查看文件内容：`python utils.py view app_state.json`

### 问题2：特定任务失败
**原因**：操作未正确执行或数据未记录
**解决**：
1. 查看对应的JSON文件内容
2. 重新执行操作
3. 检查操作步骤是否正确

### 问题3：找不到测试文件
**原因**：tests目录或文件不存在
**解决**：
```bash
# 重新生成测试文件
python generate_test_files.py
```

## 💡 提示

1. **逐个测试**：建议一个任务一个任务地测试，便于定位问题
2. **及时记录**：每完成一个任务就更新测试清单
3. **查看数据**：测试失败时用 `python utils.py view` 查看JSON内容
4. **参数化测试**：支持参数的任务可以测试不同的数据
5. **保持App运行**：测试期间保持App在前台，确保数据实时更新

## 📚 相关文档

- `测试清单.md` - 所有任务的详细列表和进度跟踪
- `验证逻辑表.md` - 每个任务的判断标准
- `README.md` - 完整的技术文档
- `快速开始.md` - 5分钟上手指南

## 🎯 目标

通过这套独立测试文件系统，您可以：
- ✅ 灵活地测试任意单个任务
- ✅ 快速验证操作是否成功
- ✅ 方便地调试特定功能
- ✅ 清晰地追踪测试进度

祝测试顺利！ 🎵
